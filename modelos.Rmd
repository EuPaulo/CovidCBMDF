---
title: "COVID-19 CBMDF"
output:
  html_document:
    toc: true
    toc_float: true
    toc_collapsed: true
---

## SEIR
### Tempos de infec√ß√£o para um modelo SEIR


<center>

![Tempos de infec√ß√£o. Retirado de: ](www/tempos.png)

</center>

A epidemiologia √© a ci√™ncia que relaciona os diversos fatores que influenciam a ocorr√™ncia de doen√ßas na popula√ß√£o humana. Essa rela√ß√£o pode ser compreendida por meio da elabora√ß√£o e da utiliza√ß√£o de modelos epidemiol√≥gicos capazes fornecer informa√ß√µes qualitativas e quantitativas acerca das caracter√≠sticas de uma doen√ßa e sua dissemina√ß√£o.    
    
Um dos modelos epidemiol√≥gicos mais utilizados no mundo √© o SEIR (Suscet√≠veis, Expostos, Infectados e Recuperados) (Li et. al, 1999). Trata-se de um modelo determin√≠stico compartimentado. Isto √©, a popula√ß√£o estudada √© dividida em compartimentos, a saber: Suscet√≠veis, Expostos, Infecciosos e Recuperados. A partir dessa divis√£o, observa-se como cada compartimento varia no tempo, podendo-se criar proje√ß√µes do n√∫mero de indiv√≠duos que estar√° em cada um dos compartimentos no futuro.

Em sua forma mais b√°sica, o modelo SEIR utiliza a seguinte equa√ß√£o populacional:

$N=S(t) + E(t) + I(t) + R(t)$

Desse modo, o total de indiv√≠duos de uma popula√ß√£o (N) √© dividido nos compartimentos (S,E,I,R). No caso do Distrito Federal, por exemplo, N = 3.015.268 segundo estimativas do IBGE de julho de 2019. Para a COVID-19, por ser uma doen√ßa nova, considera-se que toda a popula√ß√£o se encontra no compartimento dos suscet√≠veis, n√£o havendo, portanto, imuniza√ß√£o pr√©via. 
A partir do momento em que s√£o introduzidos infecciosos, ocorrem as transi√ß√µes entre os compartimentos, √† medida que o tempo passa. Cada uma das mudan√ßas compartimentais se d√° a determinadas taxas de varia√ß√£o. 

S ‚Äì Representa o n√∫mero de indiv√≠duos suscet√≠veis √† doen√ßa. No caso da COVID-19, considera-se que, no instante anterior √† primeira infec√ß√£o (t=0), toda a popula√ß√£o √© suscet√≠vel (N=S; E=I=R=0). Isto se d√° porque a doen√ßa √© nova, e n√£o havia indiv√≠duos com imunidade adquirida anteriormente.

E ‚Äì Representa o n√∫mero de indiv√≠duos expostos √† doen√ßa. Ou seja, infectados pela doen√ßa, mas que ainda n√£o se encontram infecciosos. Em outras palavras, n√£o possuem capacidade de infectar outros indiv√≠duos em virtude do chamado per√≠odo latente da doen√ßa, que ser√° tratado posteriormente.

I ‚Äì Representa o n√∫mero de indiv√≠duos infecciosos. Isto √©, elementos que, ap√≥s serem expostos e passarem pelo per√≠odo de lat√™ncia da doen√ßa, podem transmiti-la caso existam condi√ß√µes do mecanismo de transmiss√£o atuar. No caso da COVID-19, pode-se citar o contato com got√≠culas provenientes da tosse de indiv√≠duos infecciosos com o trato nasal de suscet√≠veis como exemplo de mecanismo de transmiss√£o. Este compartimento pode ser expandido, desmembrando-se em I1, I2 e I3, em que o grau de infec√ß√£o √© dividido entre leve, grave e cr√≠tico, respectivamente. Isto d√° origem ao modelo SEIIIR, no qual cada ‚ÄúI‚Äù possui determinada taxa de recupera√ß√£o.

R ‚Äì Representa o n√∫mero de indiv√≠duos recuperados. Esses indiv√≠duos j√° n√£o transmitem a doen√ßa e, para a COVID-19, sup√µe-se que a popula√ß√£o recuperada n√£o volta a ser suscet√≠vel. Chama-se a aten√ß√£o neste caso para a inclus√£o, em alguns modelos, dos √≥bitos no compartimento de recuperados epidemiol√≥gicos para fins de simplifica√ß√£o. 

Com a evolu√ß√£o da epidemia o n√∫mero de indiv√≠duos dos compartimentos varia. Como dito anteriormente, este movimento populacional ocorre a taxas de varia√ß√£o no tempo, as quais s√£o calculadas por meio de equa√ß√µes diferenciais ordin√°rias (MA, 2020).

$\frac{dS}{dt}= \frac{-Œ≤.IS}{N}$
  
$\frac{dE}{dt}= \frac{-Œ≤.IS}{N} - \theta E$  

$\frac{dI}{dt} =  \theta E -  \gamma I$ 

$\frac{dR}{dt} = \gamma I$
  

Este sistema de equa√ß√µes diferenciais ordin√°rias pode ser resolvido computacionalmente por meio de m√©todos num√©ricos. Entretanto, √© importante estabelecer os valores dos fatores multiplicadores (\beta, \theta e \gamma) presentes em cada uma das equa√ß√µes supracitadas. 
Esses fatores representam a probabilidade de transmiss√£o por contato, que para a COVID-19, pode ser obtida por meio das observa√ß√µes realizadas nos pa√≠ses que se encontram em est√°gio mais avan√ßado da epidemia, e os per√≠odos de transi√ß√£o entre os compartimentos do modelo. Esses per√≠odos se d√£o de acordo com os tempos de lat√™ncia, incuba√ß√£o e infecciosidade.

### Par√¢metros do Sistema de Equa√ß√µes do Modelo SEIR

O primeiro par√¢metro relevante para a obten√ß√£o da evolu√ß√£o da doen√ßa na popula√ß√£o em um dado instante do tempo √© a taxa de transmiss√£o por indiv√≠duo infeccioso (\beta), a qual √© fornecida pela seguinte express√£o:

$\beta = \frac{R_{0}}{t_{infec}}$  

Em que \R_{0}  √© o chamado n√∫mero reprodutivo b√°sico, entendido como o n√∫mero m√©dio de indiv√≠duos que um √∫nico elemento infeccioso √© capaz de infectar. Este fator √© uma caracter√≠stica da doen√ßa, sendo que, quanto mais infecciosa ela for, maior ser√° seu n√∫mero reprodutivo b√°sico. Em outras palavras, mais pessoas poder√£o ser infectadas a partir de um indiv√≠duo infeccioso. 
R_0 pode ser obtido por meio da observa√ß√£o do comportamento da doen√ßa em uma popula√ß√£o j√° afetada, ou por meio de uma rela√ß√£o entre os per√≠odos latente e infeccioso e a taxa de crescimento de infec√ß√µes (growth rate - \lambda).

$R_{0}=\frac{(\lambda+\gamma)‚àô(\lambda+\theta)}{(\gamma‚àô\theta)} $ 

No caso da aplica√ß√£o do modelo utilizado pela Unidade de Situa√ß√£o da opera√ß√£o COVID-19 do CBMDF para an√°lise de dados, a obten√ß√£o do n√∫mero reprodutivo b√°sico pode ser realizada das duas formas a depender da observa√ß√£o e da proje√ß√£o pretendida.
J√° o \t_{infec} √© dado pelo tempo m√©dio que um elemento da popula√ß√£o se encontra infeccioso, ou seja, √© capaz de transmitir a doen√ßa. Fornece o per√≠odo infeccioso, que corresponde ao per√≠odo durante o qual o infeccioso pode passar a doen√ßa para um suscet√≠vel. √â o intervalo de tempo que o indiv√≠duo permanece no compartimento dos infecciosos. A vari√°vel \gamma pode ser interpretada como a taxa de recupera√ß√£o dos indiv√≠duos, pois ap√≥s o per√≠odo infeccioso os elementos deslocam-se para o compartimento dos recuperados.

$\gamma=\frac{1}{t_{infec}}$     

O chamado per√≠odo de lat√™ncia e √© dado pela raz√£o de 1/\theta.

$\theta=\frac{1}{t_{latente}}$     

Logo, o \t_{latente} √© o intervalo de tempo em que o elemento est√° infectado, mas n√£o transmite a doen√ßa (n√£o confundir com o conceito de per√≠odo de incuba√ß√£o, que, assim como o latente, se inicia ap√≥s a exposi√ß√£o √† doen√ßa, por√©m se estende at√© o in√≠cio dos sintomas). Durante esse per√≠odo ele permanece no compartimento dos expostos at√© se tornar infeccioso. 
Com as vari√°veis definidas √© poss√≠vel carregar o modelo em ferramentas computacionais e, por meio do c√°lculo num√©rico, realizar estimativas e proje√ß√µes da dissemina√ß√£o da COVID-19 na popula√ß√£o brasileira e do Distrito Federal. Por meio dessas proje√ß√µes o CBMDF posiciona-se estrategicamente dar a resposta mais adequada √† pandemia.



## SEIIIRD

Assim como o anterior trata-se de um modelo determin√≠stico compartimentado. Por√©m, agora a popula√ß√£o estudada √© dividida em: Suscet√≠veis, Expostos, Infecciosos com divis√£o do
compartimento de infectados em tr√™s classes: Infectados leves (sintomas leves que n√£o
necessitam de hospitaliza√ß√£o), graves (casos que necessitam de hospitaliza√ß√£o), e cr√≠ticos
(casos nos quais √© necess√°rio interna√ß√£o em Unidade de Tratamento Intensivo), Recuperados e Mortos.

Nesta vers√£o do SEIIIRD implementouse tamb√©m uma matriz de contato baseada em faixas et√°rias a partir do artigo: ‚ÄúExpected impact of COVID-19 outbreak in a major metropolitan area in Brazil‚Äù do doutor em f√≠sica Tarc√≠sio M. Rocha Filho (2020). Adicionalmente, utilizaram-se dados espec√≠ficos por faixa et√°ria para hospitaliza√ß√µes e mortes. Portanto, o modelo √© mais complexo que os anteriores e envolve mais par√¢metros de entrada, visando retratar melhor a progress√£o de uma epidemia viral.

<\center>
Premissas
<\center>

O modelo assume as seguintes premissas:
  1. N√£o existe nascimento nem morte que n√£o sejam causadas pela COVID-19 na simula√ß√£o, pois n√£o representam n√∫meros significativos dentro do per√≠odo analisado;
  2. Cada indiv√≠duo encontra-se em apenas um dos compartimentos;
  3. Os indiv√≠duos infectados que n√£o se recuperam precisam passar pelos est√°gios de
infec√ß√£o em ordem de gravidade, n√£o podendo pular nenhum est√°gio;
  4. As mortes ocorrem apenas em indiv√≠duos em estado cr√≠tico;
  5. Os indiv√≠duos no est√°gio ‚ÄúExposto‚Äù est√£o no per√≠odo latente da doen√ßa, n√£o sendo ainda infecciosos;
  6. O modelo utilizado simula casos absolutos (reais), n√£o tendo rela√ß√£o direta com os casos reportados. Essa estrat√©gia foi a escolha mais sensata tendo em vista os problemas
relacionados √† subnotifica√ß√£o corrente;
  7. Utilizou-se a matriz de contato da Europa e dados referentes a interna√ß√£o e morte por
faixa et√°ria da Espanha (CCAES, 2020) e Inglaterra (ICNARC, 2020).

<\center>
Par√¢metros de entrada da simula√ß√£o:
<\center>

-Tempo de incuba√ß√£o: 5.2 dias.
-Tempo de lat√™ncia: 4.2 dias.
-Intervalo Sintoma-recupera√ß√£o: 8 dias.
-N√∫mero de leitos de UTI: 1240.
-Popula√ß√£o do DF: 3041713 pessoas.
-Fra√ß√£o de infec√ß√µes causadas por um infectado leve: 0.8.
-Fra√ß√£o de infec√ß√µes causadas por um infectado grave: 0.1.
-Fra√ß√£o de infec√ß√µes causadas por um infectado cr√≠tico: 0.1.


## Modelo Bayesiano do Imperial College

<\center>
Premissas Iniciais
<\center>

  ‚Ä¢ Foi utilizado como base a modelagem do Report 13 do Imperial College 
  ‚Ä¢ Neste ser√° utilizado um modelo Bayesiano, adaptativo, que se baseia no n√∫mero de mortos. 
  ‚Ä¢ O modelo usa ajuste realizado atrav√©s de um algoritmo HMC (Hamiltonian Monte Carlo).
  <\center>
Dados utilizados 
<\center>

  ‚Ä¢ Pir√¢mide Et√°ria: ‚ó¶ Brasil: IBGE ‚ó¶ DF: boletim epidemiol√≥gico DF
  ‚Ä¢ Total de infec√ß√µes e mortes: https://www.ecdc.europa.eu/en/covid-19-pandemic 
  ‚Ä¢ Cada estado brasileiro iniciou as medidas preventivas n√£o medicamentosas em datas distintas. O Distrito Federal, por exemplo, iniciou suas interven√ß√µes no dia 11/03/2020 j√° o Estado de S√£o Paulo anunciou suas medidas no dia 16/03/2020 e apenas iniciou o isolamento social em 23/03/2020. Foram considerados para o Brasil as datas das interven√ß√µes no Estado de S√£o Paulo, por ser o estado com a maior concentra√ß√£o de infectados e mortos no pa√≠s. 
  ‚Ä¢ A mortalidade do v√≠rus no pa√≠s foi calculada a partir dos dados da ecdc. (link: https://www.ecdc.europa.eu/en/covid-19-pandemic)  
  ‚Ä¢ Tempo de incuba√ß√£o do v√≠rus: 5.1 dias 
  ‚Ä¢ Tempo entre a apresenta√ß√£o dos sintomas e a morte: 18.8 dias
 <\center> 
  Modelos Matem√°ticos
  <\center>
  Mortes 
  
Para calcular uma previs√£o de novos casos por dia foi usado o proposto pelo  Report 13 do Imperial College:

 $D_{t,m} ~  \sim {\sf negative Binom}(d_{t,m},  d_{t,m} + \frac{d_{t,m}^{2}}{\psi},)$
 
 $\psi~Normal(0.5)$Ì∞∑

Sendo que o n√∫mero esperado de mortes d em um determinado local em um determinado dia √© uma fun√ß√£o do n√∫mero de infec√ß√µes c que ocorrem nos dias anteriores. 

No in√≠cio da epidemia, as mortes observadas em um pa√≠s podem ser donominadas pelas mortes resultantes de infec√ß√µes n√£o-locais. Para que o modelo n√£o fosse influenciado por essas mortes foram inclu√≠das no modelo apenas as mortes observadas no dia seguinte ao de um pa√≠s ter cumulativamente 10 mortes.

Para vincular mecanicamente as fun√ß√µes de mortes e casos infectados, o autor usou uma taxa de fatalidade ifr. Usando informa√ß√µes epidemiol√≥gicas estimadas em outros estudos, o autor assumiu que \pi √© a soma de dois tempos aleat√≥rios independentes: a distribui√ß√£o do per√≠odo de incuba√ß√£o e o tempo entre o in√≠cio dos sintomas e a morte (in√≠cio ao √≥bito) e com esta calculou uma distribui√ß√£o da infec√ß√£o at√© a morte œÄ, dada por:

$\pi~ifr . (Gamma(5.1,0.86) + Gamma(18.8,0.45))$


ùëñùëü Onde 5.1 √© a tempo de incuba√ß√£o e 0.86 seu o coeficiente de varia√ß√£o e 18.8 √© o tempo entre a apresenta√ß√£o dos sintomas e a morte e 0.45 seu coeficiente de varia√ß√£o.

Usando a probabilidade de distribui√ß√£o das mortes, o n√∫mero esperado de mortes \d_{t,m} em um determinado dia t, para o pa√≠s m, √© dado pela seguinte soma discreta:

$$\sum_{\tau=0}^{t-1} c_{t,m} \pi_{t-\tau,m}$$

Onde \tau √© o n√∫mero de novas infec√ß√µes no dia \tau no pa√≠s m.

Para modelar o n√∫mero de infec√ß√µes ao longo do tempo, foi especificado uma s√©rie de distribui√ß√£o de intervalo g com densidade g(\tau), (o tempo entre o momento em que uma pessoa √© infectada e quando infecta posteriormente outras pessoas) que √© distribu√≠da por gama. Dado g, o n√∫mero de infec√ß√µes di√°rias c_{t,m} em um dado dia t e em um determinado pa√≠s m √© dado pela fun√ß√£o de convolu√ß√£o:

$$c_{t,m} = R_{t,m} \sum_{\tau=0}^{t-1} c_{\tau,m} g_{t-\tau}$$ 

e R_{t,m}  dado por: 

$$R_{t,m} = R_{0,m} exp( -\sum_{k=1}^{6} \alpha{k} I_{k,t,m})$$ 

Onde k representa o tipo de Interven√ß√£o adotada na localidade (s√£o consideradas 6), I_{k,t,m} representa a interven√ß√£o e Œ± o peso dessa interven√ß√£o.

